@using siges.Models
@using System
@using System.Collections.Generic
@{
List<Operador> osAtendido = ViewData["osAtendido"] as List<Operador>;
}

<div class="jumbotron">
  <h1 class="display-4">@(osAtendido.Count > 0 ? osAtendido[0].OrdenServicio.Cliente.RazonSocial : "Sin Reporte de actividad")</h1>
  <p class="lead">@(osAtendido.Count > 0 ? osAtendido[0].OrdenServicio.Ubicacion.Nombre : "para esta Orden de Servicio")</p>
  <hr class="my-4">
  <p>@(osAtendido.Count > 0 ? osAtendido[0].OrdenServicio.Servicio.Nombre : "")</p>

  <div class="row p-2">
    <div class="col-md-12">
      @if(osAtendido != null && osAtendido.Count > 0){
      @foreach ( var osAten in osAtendido) {
      @foreach (var estado in osAten.EstadoN as List<Operador.Estado>) {
      <div class="p-3">
        <div class="card text-center">
          <div class="card-header">@osAten.Hora.ToString("D")</div>
          <div class="card-body">
            <h5 class="card-title">@(estado.NuevoEstado == "sitio" ? "En sitio:" : (estado.NuevoEstado=="noatendido"?"Reporte de actividad:":"Atendido:"))</h5>
            <p class="card-text">@estado.ComentarioNuevoEstado</p>
            @if(estado.ArchivosEvidencia != null && estado.ArchivosEvidencia.Count > 0){
            @foreach(var archivo in estado.ArchivosEvidencia as List<Operador.Estado.Archivo>){
            <button type="button" class="btn btn-primary" onclick="location.href='@Url.Action( "MostrarArchivo", "Operador", new{@osId=@osAten.OrdenServicio.Id, @operadorEstadoId=@estado.Id, @operadorEstadoArchivoId = @archivo.Id})'">@archivo.Name</button>
            }
            }
          </div>
          <div class="card-footer text-muted"><b>@(String.Format("{0} {1}", @osAten.Persona.Nombre, @osAten.Persona.Paterno).ToUpper())</b></div>
        </div>
      </div>
      }
      }
      }
    </div>
  </div>

  <button class="btn btn-success btn-lg" type="button" onclick="location.href='@Url.Action( "Index", "Operador")'" >Regresar</button>
</div>
